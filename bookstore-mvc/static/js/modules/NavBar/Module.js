define("hbs!templates/NavBar/navbar",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){function l(e,t){var n="",r;return n+='\n        <ul class="nav navbar-nav navbar-right">\n            <li><a href="#" class="shopcart-toggle"><span class="glyphicon glyphicon-shopping-cart"></span> My shopcart</a></li>\n            <li><a href="#profile"><span class="glyphicon glyphicon-user"></span> '+a((r=(r=e&&e.user,r==null||r===!1?r:r.username),typeof r===u?r.apply(e):r))+'</a></li>\n            <li class="dropdown">\n                <a href="#" class="dropdown-toggle" data-toggle="dropdown">User menu <b class="caret"></b></a>\n                <ul class="dropdown-menu">\n                    <li><a href="#profile">Profile</a></li>\n                    <li><a href="#orders">Orders</a></li>\n                    <li><a href="#wishlist">Something else here</a></li>\n                    <li><a href="#favbooks">Something else here</a></li>\n                    <li><a href="#settings">Settings</a></li>\n                    <li class="divider"></li>\n                    <li><a href="#signout">Sign out</a></li>\n                </ul>\n            </li>\n        </ul>\n        ',n}function c(e,t){return'\n        <div class="navbar-right nav-actions unlogged">\n            <ul class="nav navbar-nav actions-in-navbar">\n                <li><a href="#" class="shopcart-toggle"><span class="glyphicon glyphicon-shopping-cart"></span> My shopcart</a></li>\n            </ul>\n            <button type="button" id="signInAction" data-toggle="modal" data-target="#signInModal" class="btn btn-default navbar-btn">Sign in</button>\n            <button type="button" id="signUpAction" data-toggle="modal" data-target="#signUpModal" class="btn btn-success navbar-btn">Sign up</button>\n        </div>\n        '}function h(e,t){return'\n<div class="modal fade" id="signInModal" tabindex="-1" role="dialog" aria-labelledby="signInModalLabel" aria-hidden="true">\n    <div class="modal-dialog">\n        <div class="modal-content modal-sign-in">\n            <div class="modal-header">\n                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>\n                <h4 class="modal-title" id="myModalLabel">Sign in</h4>\n            </div>\n            <div class="modal-body">\n                <form id="signInForm">\n                    <div class="form-group">\n                        <label for="signInForm_Login">Login / email</label>\n                        <input type="text" class="form-control" id="signInForm_Login" placeholder="Enter your login">\n                    </div>\n                    <div class="form-group">\n                        <label for="signInForm_Password">Password</label>\n                        <input type="password" class="form-control" id="signInForm_Password" placeholder="Enter password">\n                    </div>\n                </form>\n            </div>\n            <div class="modal-footer">\n                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                <button type="button" class="btn btn-success" id="signInSubmit">Sign in</button>\n            </div>\n        </div>\n    </div>\n</div>\n<div class="modal fade" id="signUpModal" tabindex="-1" role="dialog" aria-labelledby="signUpModalLabel" aria-hidden="true">\n    <div class="modal-dialog">\n        <div class="modal-content">\n            <div class="modal-header">\n                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>\n                <h4 class="modal-title" id="signUpModalLabel">Sign up</h4>\n            </div>\n            <div class="modal-body clearfix">\n                <form id="signUpForm">\n                    <div class="col-md-6">\n                        <div class="form-group">\n                            <label for="signUpForm_Username">Username</label>\n                            <input type="text" class="form-control" id="signUpForm_Username" placeholder="Enter your username">\n                        </div>\n                        <div class="form-group">\n                            <label for="signUpForm_Email">Email</label>\n                            <input type="text" class="form-control" id="signUpForm_Email" placeholder="Enter your email">\n                        </div>\n                        <div class="form-group">\n                            <label for="signUpForm_Password">Password</label>\n                            <input type="password" class="form-control" id="signUpForm_Password" placeholder="Enter password">\n                        </div>\n                    </div>\n                    <div class="col-md-6">\n                        <div class="text-center register-avatar">\n                            <img class="img-rounded img-rounded" src="static/img/users/default.png" />\n                        </div>\n                    </div>\n                </form>\n            </div>\n            <div class="modal-footer">\n                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                <button type="button" class="btn btn-success" id="signUpSubmit">Sign up</button>\n            </div>\n        </div>\n    </div>\n</div>\n'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div id="headerNavBar" class="navbar navbar-custom-header" role="navigation">\n    <div class="navbar-header">\n        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#headerNavBarCollapse">\n            <span class="sr-only">Toggle navigation</span>\n            <span class="icon-bar"></span>\n            <span class="icon-bar"></span>\n            <span class="icon-bar"></span>\n        </button>\n        <a class="navbar-brand" href="#"><span class="glyphicon glyphicon-book"></span> Yet Another Book Store</a>\n    </div>\n    <div class="clearfix collapse navbar-collapse" id="headerNavBarCollapse">\n        ',o=n["if"].call(t,t&&t.user,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i)});if(o||o===0)s+=o;s+='\n    </div>\n    <div class="shopcart-region hide">\n\n    </div>\n</div>\n',o=n.unless.call(t,t&&t.user,{hash:{},inverse:f.noop,fn:f.program(5,h,i)});if(o||o===0)s+=o;return s});return n}),define("modules/vent",["backbone","marionette"],function(e,t){return new e.Wreqr.EventAggregator}),define("modules/NavBar/Layout/Bar",["marionette","hbs!templates/NavBar/navbar","modules/vent","bootstrap"],function(e,t,n){var r=e.Layout.extend({template:t,events:{"click #signInSubmit":"onSignInSubmit","click #signUpSubmit":"onSignUpSubmit"},ui:{signInLogin:"#signInForm_Login",signInPassword:"#signInForm_Password",signUpUsername:"#signUpForm_Username",signUpPassword:"#signUpForm_Password",signUpEmail:"#signUpForm_Email"},regions:{shopcartRegion:".shopcart-region"},onRender:function(){this.initShopcart()},initShopcart:function(){var e=this,t=this.$(".shopcart-toggle");t.click(function(e){e.preventDefault()}),t.popover({animation:!1,placement:"bottom",html:!0,title:"My Shopcart",content:function(){return e.shopcartRegion.$el.find(".shopcart")},container:this.$("#headerNavBar")}),t.on("hide.bs.popover",function(){var t=e.shopcartRegion.$el,n=e.$(".shopcart");t.append(n)})},closeShopcartPopover:function(){this.$(".shopcart-toggle").popover("hide")},onSignInSubmit:function(e){e.preventDefault();var t=this.ui.signInLogin.val(),n=this.ui.signInPassword.val();t&&n&&this.trigger("signInSubmit",{login:t,password:n})},closeSignInModal:function(e){var t=this.$("#signInModal");t.on("hidden.bs.modal",e),t.modal("hide")},onSignUpSubmit:function(e){e.preventDefault();var t=this.ui.signUpUsername.val(),n=this.ui.signUpPassword.val(),r=this.ui.signUpEmail.val();t&&n&&r&&this.trigger("signInSubmit",{login:t,password:n})},serializeData:function(){return{user:this.options.loggedUser}}});return r}),define("hbs!templates/NavBar/shopcart/actions",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){function u(e,t){return'\n    <button id="shopcartCheckoutAction" class="btn btn-danger">Checkout!</button>\n    <button id="shopcartClearAction" class="btn btn-default">Clear</button>\n'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s,o=this;return s=n["if"].call(t,t&&t.items,{hash:{},inverse:o.noop,fn:o.program(1,u,i)}),s||s===0?s:""});return n}),define("modules/NavBar/View/Shopcart/Actions",["marionette","hbs!templates/NavBar/shopcart/actions"],function(e,t){var n=e.ItemView.extend({template:t,events:{"click #shopcartCheckoutAction":"onCheckout","click #shopcartClearAction":"onClear"},collectionEvents:{"reset add remove":"render"},onCheckout:function(e){e.preventDefault()},onClear:function(e){e.preventDefault(),this.trigger("shopcartReset")}});return n}),define("hbs!templates/NavBar/shopcart/item",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u,a="function",f=this.escapeExpression;return s+='<div class="row clearfix shopcart-item">\n    <div class="col-md-2">\n        <img src="',(o=n.picture)?o=o.call(t,{hash:{}}):(o=t&&t.picture,o=typeof o===a?o.call(t,{hash:{}}):o),s+=f(o)+'" class="item-picture" />\n    </div>\n    <div class="col-md-7">\n        <div class="title">\n            '+f((o=(o=t&&t.info,o==null||o===!1?o:o.title),typeof o===a?o.apply(t):o))+'\n        </div>\n        <div class="sub-title">\n            '+f((o=(o=t&&t.info,o==null||o===!1?o:o.additional),typeof o===a?o.apply(t):o))+'\n        </div>\n    </div>\n    <div class="col-md-3">\n        <div class="price">\n            ',(u=n.price)?u=u.call(t,{hash:{}}):(u=t&&t.price,u=typeof u===a?u.call(t,{hash:{}}):u),s+=f(u)+"\n        </div>\n    </div>\n</div>",s});return n}),define("modules/NavBar/View/Shopcart/Item",["marionette","hbs!templates/NavBar/shopcart/item"],function(e,t){var n=e.ItemView.extend({template:t});return n}),define("hbs!templates/NavBar/shopcart/empty",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<div class="empty-shopcart-message text-center">\n    <span class="glyphicon glyphicon-shopping-cart"></span> Shopcart is empty :(\n</div>'});return n}),define("modules/NavBar/View/Shopcart/Empty",["marionette","hbs!templates/NavBar/shopcart/empty"],function(e,t){var n=e.ItemView.extend({template:t});return n}),define("hbs!templates/NavBar/shopcart/collection",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<div class="active-items">\n\n</div>\n<div class="show-more text-center">\n    <a href="#">Show more books in shopcart</a>\n</div>'});return n}),define("modules/NavBar/View/Shopcart/Collection",["marionette","modules/NavBar/View/Shopcart/Item","modules/NavBar/View/Shopcart/Empty","hbs!templates/NavBar/shopcart/collection"],function(e,t,n,r){var i=e.CompositeView.extend({template:r,itemView:t,itemViewContainer:".active-items",emptyView:n,activeViewsCount:5,initialize:function(){this.listenTo(this.collection,"add remove",this.checkActiveShopcartItems,this),this.listenTo(this.collection,"reset",this.checkActiveResetShopcart,this)},checkActiveShopcartItems:function(){var t=e.getOption(this,"activeViewsCount")-1,n=this.children.length;this.children.each(function(e,r){r<n-t&&e.close()});var r=this.$(".show-more");n>t?r.show():r.hide()},checkActiveResetShopcart:function(){var e=this.$(".show-more");e.hide()},onShow:function(){this.checkActiveShopcartItems()},appendHtml:function(e,t,n){e.isBuffering?e.elBuffer.appendChild(t.el):e.$el.prepend(t.$el)}});return i}),define("hbs!templates/NavBar/shopcart/layout",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<div class="shopcart">\n    <div class="shopcart-items-container">\n        <div class="active-items">\n\n        </div>\n        <div class="show-more text-center">\n            <a href="#">Show full shopcart</a>\n        </div>\n    </div>\n    <div class="actions text-center">\n\n    </div>\n</div>'});return n}),define("modules/NavBar/View/Shopcart/Layout",["marionette","hbs!templates/NavBar/shopcart/layout"],function(e,t){var n=e.Layout.extend({template:t,regions:{itemsContainerRegion:".shopcart-items-container",actionsRegion:".actions"}});return n}),define("hbs!templates/Common/loading",["hbs","hbs/handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){function l(e,t){var r="",i;return r+="\n    <h4>",(i=n.title)?i=i.call(e,{hash:{}}):(i=e&&e.title,i=typeof i===u?i.call(e,{hash:{}}):i),r+=a(i)+"</h4>\n",r}function c(e,t){var r="",i;return r+="\n    <p>",(i=n.message)?i=i.call(e,{hash:{}}):(i=e&&e.message,i=typeof i===u?i.call(e,{hash:{}}):i),r+=a(i)+"</p>\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression,f=this;o=n["if"].call(t,t&&t.title,{hash:{},inverse:f.noop,fn:f.program(1,l,i)});if(o||o===0)s+=o;s+="\n",o=n["if"].call(t,t&&t.message,{hash:{},inverse:f.noop,fn:f.program(3,c,i)});if(o||o===0)s+=o;return s+='\n<div class="spinner">\n    <img src="static/img/common/spinner.gif"/>\n</div>\n',s});return n}),define("modules/Common/View/Loading",["marionette","spin","hbs!templates/Common/loading"],function(e,t,n){var r=e.ItemView.extend({template:n,tagName:"div",className:"spinner-container",serializeData:function(){return{title:this.options.title,message:this.options.message}},onShow:function(){}});return r}),define("modules/NavBar/Controller",["marionette","backbone","modules/NavBar/Layout/Bar","modules/NavBar/View/Shopcart/Actions","modules/NavBar/View/Shopcart/Collection","modules/NavBar/View/Shopcart/Layout","modules/Common/View/Loading","modules/app"],function(e,t,n,r,i,s,o,u){var a=e.Controller.extend({initialize:function(){},showNavBar:function(){this.refreshNavBar()},refreshNavBar:function(){var e=this,o=new n({loggedUser:u.userSession.userData});o.on("signInSubmit",function(t){u.userSession&&u.userSession.auth(t.login,t.password)&&o.closeSignInModal(function(){e.refreshNavBar()})}),u.headerRegion.show(o);var a=o.$("#headerNavBar");a.scrollToFixed({zIndex:500});var f=new s;f.render();var l=new t.Collection(u.shopcart.products||[]),c=new i({collection:l}),h=new r({collection:l});o.shopcartRegion.show(f),f.itemsContainerRegion.show(c),f.actionsRegion.show(h);var p=function(e){l.add(e)};u.shopcart.off("addProduct",p),u.shopcart.on("addProduct",p),h.on("shopcartReset",function(){o.closeShopcartPopover(),l.reset([]),u.shopcart.reset()})}});return a}),define("modules/NavBar/Module",["marionette","modules/NavBar/Controller","modules/app"],function(e,t,n){n.module("NavBar",function(e){e.addInitializer(function(e){var n=new t;n.showNavBar()})})});
